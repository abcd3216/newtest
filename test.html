<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <title>C語言線上AI互動學習平台 - 超完整初學者小幫手版</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.4.12/ace.js"></script>
    <style>
        body {
            background-color: #f4f6f9;
            font-family: 'Arial', sans-serif;
            margin: 0;
            padding: 20px;
        }
        .container {
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        .top-right-buttons {
            width: 80%;
            display: flex;
            justify-content: flex-end;
            margin-bottom: 10px;
        }
        .top-right-buttons button {
            margin-left: 10px;
            padding: 10px 16px;
            border: none;
            border-radius: 20px;
            font-size: 14px;
            cursor: pointer;
        }
        #runBtn {
            background-color: #4CAF50;
            color: white;
        }
        #submitBtn {
            background-color: #f78da7;
            color: white;
        }
        #editor {
            width: 80%;
            height: 300px;
            border: 1px solid #ccc;
            margin-bottom: 20px;
        }
        #tipsArea, #outputArea {
            width: 80%;
            background-color: #e6f7ff;
            padding: 15px;
            border-radius: 8px;
            border: 1px solid #91d5ff;
            color: #333;
            margin-bottom: 20px;
        }
        #tipsTitle, #outputTitle {
            font-weight: bold;
            margin-bottom: 10px;
        }
    </style>
</head>
<body>
<div class="container">

    <!-- 右上角按鈕列 -->
    <div class="top-right-buttons">
        <button id="runBtn">執行程式</button>
    </div>

    <!-- 程式碼輸入區 -->
    <div id="editor">#include &lt;stdio.h&gt;

int main() {
    printf("你好家生\n");
    return 0;
}</div>

    <!-- Tips 區域 -->
    <div id="tipsArea">
        <div id="tipsTitle">Tips：</div>
        <div id="tipsContent">目前尚未偵測到內容錯誤。</div>
    </div>

    <!-- 輸出區域 -->
    <div id="outputArea">
        <div id="outputTitle">目前輸入的程式碼：</div>
        <pre id="outputContent"></pre>
    </div>

</div>

<script>
    const editor = ace.edit("editor");
    editor.setTheme("ace/theme/github");
    editor.session.setMode("ace/mode/c_cpp");

    // Tips 檢查
    editor.session.on('change', function(delta) {
        const code = editor.getValue();
        const lines = code.split('\n');
        let tips = [];

        if (!code.includes('main')) {
            tips.push("警告：偵測到你的程式碼沒有 main 函式。");
        }

        lines.forEach((line, index) => {
            const trimmed = line.trim();
            if (trimmed.length > 0 && !trimmed.startsWith("#") && !trimmed.endsWith(";") && !trimmed.endsWith("{") && !trimmed.endsWith("}")) {
                tips.push(`第 ${index + 1} 行可能缺少分號 ';'。`);
            }
        });

        const scanfIssues = code.match(/scanf\s*\(\s*\"%s\"\s*,\s*&\s*\w+\s*\)/g);
        if (scanfIssues) {
            tips.push("提醒：使用 scanf(\"%s\", input); 時，不需要加 &，因為字元陣列本身就是指標。");
        }

        if (code.includes('gets(')) {
            tips.push("警告：偵測到使用 gets()，建議改用更安全的 fgets()。例如：fgets(input, sizeof(input), stdin);");
        }

        if (code.includes('printf("') && !code.includes('%') && !code.includes('\"')) {
            tips.push("提醒：printf() 如果要輸出變數，請記得加格式控制字元（如 %d, %s）。");
        }

        document.getElementById("tipsContent").innerHTML = tips.length ? tips.join('<br>') : "目前尚未偵測到內容錯誤。";
    });

    // 執行按鈕功能
    document.getElementById("runBtn").addEventListener("click", function() {
        const code = editor.getValue();
        document.getElementById("outputContent").textContent = code;
    });
</script>

</body>
</html>
